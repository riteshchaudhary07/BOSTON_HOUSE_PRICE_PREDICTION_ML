# -*- coding: utf-8 -*-
"""Copy of ML_PROJECT01

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KurPaPCu2c-j_M4hwYd5o1IVBk_qNVEb
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

import seaborn as sns

from sklearn.datasets import fetch_openml
import pandas as pd

# Load Boston Housing from OpenML
boston = fetch_openml(name="boston", version=1, as_frame=True)

X = boston.data
y = boston.target

data = pd.concat([X, y.rename("MEDV")], axis=1)
data.head()

data.describe()

data.corr()

sns.pairplot(data)

plt.scatter(data['CRIM'],data['MEDV'])

sns.regplot(x='CRIM',y='MEDV',data=data)

"""selecting dependent and independent featutres by slecting x and y values"""

# Independent features
X = data.iloc[:, :-1]

# Dependent feature (target)
y = data.iloc[:, -1]

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

print("X_train:", X_train.shape)
print("X_test:", X_test.shape)
print("y_train:", y_train.shape)
print("y_test:", y_test.shape)

"""standarisation of dataset"""

from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()

X_train = scaler.fit_transform(X_train)

X_test = scaler.transform(X_test)

#

X_train

X_test

"""TRAINING MODEL

"""

from sklearn.linear_model import LinearRegression

regression=LinearRegression()

regression.fit(X_train,y_train)

regression.coef_

regression.intercept_

"""to know on which parameter model will be trained"""

regression.get_params()

"""prediction with trained data


"""

reg_prediction=regression.predict( X_test)

"""PLOT THE SCATTER PLOT FOR PREDICTION"""

plt.scatter(y_test,reg_prediction)
#

residuals=y_test-reg_prediction # error in model
print(residuals)

sns.distplot(residuals)

from sklearn.metrics import mean_squared_error
from sklearn.metrics import mean_absolute_error
print(mean_absolute_error(y_test,reg_prediction))
print(mean_squared_error(y_test,reg_prediction))

"""R SQUARE AND ADJUSTED R SQUARE"""

from sklearn.metrics import r2_score
r2=r2_score(y_test,reg_prediction)
print(r2)

# TO DISPLAY ADJUSTED R SQUARE
adjusted_r2 = 1 - (1 - r2) * (y_test.shape[0] - 1) / (y_test.shape[0] -X_test.shape[1] - 1)
adjusted_r2

"""new dataprediction

picking the model file for deployment
"""

#Pickling (Saving & Loading) a Machine Learning Model in Python ðŸ§ ðŸ’¾

#Pickling means saving a trained ML model to disk so you can reuse it later without retraining.
import pickle

# save model
with open("linear_reg_model.pkl", "wb") as file:
    pickle.dump(reg_model, file)

from sklearn.linear_model import LinearRegression

regression = LinearRegression()
regression.fit(X_train, y_train)

import pickle

with open("linear_reg_model.pkl", "wb") as file:
    pickle.dump(regression, file)

with open("linear_reg_model.pkl", "rb") as file:
    pickled_model = pickle.load(file)

pickle.dump(regression, open('regmodel.pkl', 'wb'))
pickled_model = pickle.load(open('regmodel.pkl', 'rb'))

